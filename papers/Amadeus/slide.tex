\documentclass[compress]{beamer}
\useoutertheme[footline=authortitle,subsection=false]{miniframes}
\setbeamertemplate{navigation symbols}{}

\definecolor{vertmoyen}{HTML}{A9CB60}
\definecolor{vertclair}{HTML}{D3F192}
\definecolor{vertfonce}{HTML}{347003}
\definecolor{deletecol}{HTML}{3B8A13}
\definecolor{addcolor} {HTML}{9E0270}

\usecolortheme[named=vertfonce]{structure}

\setbeamercolor{section in head/foot}{fg=vertfonce,bg=vertmoyen}
\setbeamercolor{author in head/foot}{fg=white}
\setbeamercolor{titlelike}{bg=vertclair}
\setbeamertemplate{mini frame in other subsection}[default][0!white!100]
\setbeamertemplate{section in head/foot shaded}[default][0!white!100]

%\usepackage{etex,pgfpages}
%\pgfpagesuselayout{8 on 1}[a4paper,shrink=3cm]

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}

\usepackage{kpfonts}

\usepackage{amsmath,bussproofs}

\usepackage{graphics,booktabs,array}

\title{Combining RecyclePivotsWithIntersection and LowerUnits}
\author[Joseph Boudou]{Joseph Boudou, Bruno Woltzenlogel Paleo}

\def\fCenter{\mbox{\large\ $\vdash$\ }}
\newcommand{\InfDesc}[1]{\RightLabel{\tiny $(#1)$}}

\newcommand{\siecle}[1]{\textsc{\romannumeral #1}\textsuperscript{e}~siècle}

\newenvironment{subpart}[1]
{ \begin{block}{#1}
  \begin{itemize}
}{
  \end{itemize}
  \end{block}
}

\usepackage[vlined]{algorithm2e}

\usepackage{tikz}
\usetikzlibrary{arrows,matrix,positioning}

\newcommand{\chartscale}{1}

\tikzstyle{proof edge}=[thick,cap=round]
\tikzstyle{deleted edge}=[proof edge, dashed, color=deletecol]

\newcommand{\proofnode}[3][]{
  \node [anchor=mid, #1] (#2) {#3}
}

\newcommand{\rootnode}[1][]{
  \proofnode[#1]{root}{$\bot$}
}

\newcommand{\drawchildren}[3]{
  \draw [proof edge] (#1) -- (#2);
  \draw [proof edge] (#1) -- (#3)
}

\newcommand{\addchildren}[5]{
  \proofnode[above left  of=#1]{#2}{#3};
  \proofnode[above right of=#1]{#4}{#5}
}

\newcommand{\withchildren}[5]{
  \addchildren{#1}{#2}{#3}{#4}{#5};
  \drawchildren{#1}{#2}{#4}
}

\newcommand<>{\crossnode}[2][]{{
  \only#3{
    \draw [color=deletecol,thick,cap=round,#1] (#2.mid) ++(10:0.3) -- ++(190:0.6);
%    \draw [color=red,thick,cap=round,#1] (#2.north west) -- (#2.south east);
  }
}}

\newcommand<>{\pivot}[3][]{{
  \only#4{
    \node [anchor=base,color=vertfonce,#1] at (#2.north) {\scriptsize #3};
  }
}}

%\includeonly{combination-chart,composition-chart,combluniv-chart}
%%%%%%%%%%%%%%%%%%
% Begin Document %
%%%%%%%%%%%%%%%%%%
\begin{document}

\tikzset{bottomrule/.style={%
    execute at end cell={%
        \draw [line cap=rect,#1] (\tikzmatrixname-\the\pgfmatrixcurrentrow-\the\pgfmatrixcurrentcolumn.south west) -- (\tikzmatrixname-\the\pgfmatrixcurrentrow-\the\pgfmatrixcurrentcolumn.south east);%
        }
    }
}

\begin{frame}
\date{October 2012}
\titlepage
\end{frame}

\begin{frame}{Overview}
\tableofcontents
\end{frame}

\begin{frame}{Benchmarks}
  \begin{subpart}{1000 proofs from VeriT}
    \item 100 SAT proof from the old external SAT solver
    \item 900 SMT proofs translated to propositional resolution
  \end{subpart}
  \begin{block}{Algorithms implemented in Scala for Skeptik}
  \end{block}
\end{frame}

\section{Introduction}
\subsection{RPI, LU, composing them}

\begin{frame}{RPI}
  \begin{subpart}{Regularization}
    \item A prood node is regular if its pivot is not reused on any path to the root.
    \item Full regularization might lead to bigger proofs.
  \end{subpart}
  \begin{subpart}{Recycle Pivots with Intersections}
    \item Extends RecyclePivots.
    \item Delete a branch only if its pivot appears on every path from the root to the node.
  \end{subpart}
  \begin{subpart}{Two traversals}
    \item Collect \emph{safe literals} and mark edges to delete.
    \item Delete edges and fix the proof.
  \end{subpart}
\end{frame}

\begin{frame}{LU}
  \begin{subpart}{Lowering}
    \item Moving a node down the proof to resolve it only once.
    \item Units can always be lowered.
  \end{subpart}
  \begin{subpart}{Lowering Units}
    \item Lower every unit with more than one child.
    \item Reduces \emph{horizontal irregularities}.
  \end{subpart}
  \begin{subpart}{Two traversals}
    \item Collect units with more than one child.
    \item Delete units and fix the proof then reintroduce units.
  \end{subpart}
\end{frame}

\begin{frame}{Sequential Composition}
\centering
\include{composition-chart}
\end{frame}


\section{Difficulties}
\subsection{to find a combined algorithm always at least as good as both compositions}

\begin{frame}{Irregular Units}
  \begin{center}
\begin{tikzpicture}[node distance=1.3cm]
  \proofnode[color=addcolor]{luroot}{\only<4>{$\bot$}};

  \proofnode[above left of=luroot]{root}{\alt<3-4>{$\bar{a}$}{$\bot$}};
  \withchildren{root} {r2}{\alt<3-4>{$\bar{a} c$}{$c$}} {a4}{$\bar{c}$};
  \withchildren{r2} {r0}{\alt<8>{$b c$}{$b$}} {r1}{$\bar{b} c$};

  \addchildren{r0} {a0}{$\bar{a} b$} {iu}{$a$};
  \draw [proof edge] (r0) -- (a0);
  \only<1,5->{\draw [proof edge] (r0) -- (iu);}
  \only<2>{\draw [deleted edge] (r0) -- (iu);}

  \addchildren{iu} {a1}{$a c$} {a2}{$a \bar{c}$};
  \draw [proof edge] (iu) -- (a1);
  \only<1-6>{\draw [proof edge] (iu) -- (a2);}
  \only<7>{\draw [deleted edge] (iu) -- (a2);}

  \proofnode[above right of=r1]{a3}{$\bar{a} \bar{b} c$};
  \draw [proof edge] (r1) -- (a3);
  \only<1,5->{\draw [proof edge] (r1) -- (iu);}
  \only<2>{\draw [deleted edge] (r1) -- (iu);}

  \crossnode<3-4>{r0}
  \crossnode<3-4>{r1}
  \only<4>{
    \draw [proof edge,color=addcolor] (luroot) -- (root);
    \draw [proof edge,color=addcolor] (luroot) .. controls ++(1.2,1.5) .. (iu);
  }

  \pivot<6-7>{iu}{$c$}
  \pivot<6->{root}{$c$}
  \crossnode<8>{a2}
  \crossnode<8>{iu}

  \draw (luroot) ++(1.2,-0.5) node {};
\end{tikzpicture}
\end{center}
\end{frame}

\begin{frame}{Root Safe Literals}
\end{frame}

\begin{frame}{Units introduced by RPI}
\end{frame}

\begin{frame}{Back to Irregular Units}
\end{frame}


\section{Combined Equivalents}
\subsection{to both sequential compositions}

\begin{frame}{RPI[3]LU}
\begin{subpart}{Three traversals}
  \item collect units and compute the \emph{root safe literals} ;
  \item compute safe literals and mark edges to be deleted ;
  \item fix the proof and reintroduce units.
\end{subpart}
\begin{subpart}{Implementation}
  \item Many corner cases
  \item Twice as fast as RPI.LU
\end{subpart}
\end{frame}

\begin{frame}{RPI[3]LU vs RPI.LU}
\centering
\only<+>{\include{3pass-compress}}
\only<+>{\include{3pass-time}}
\end{frame}

\begin{frame}{LUnivRPI}
\end{frame}

\section{LowerUnivalents}
\subsection{A new algorithm extending LU}

\begin{frame}{Lowering a node}
  \begin{subpart}{The (generalized) problem}
    \item Given $\psi[\eta] \odot_{a_1} \eta_1 \odot_{a_2} \cdots \odot_{a_n} \eta_n$
    \item is $\psi_{\text{\tiny fixed}}[] \odot_a \eta \odot_{a_1} \eta_1 \odot_{a_2} \cdots \odot_{a_n} \eta_n$ equivalent ?
  \end{subpart}
  \begin{subpart}{It depends on}
    \item $\eta$ and its children in $\psi[\eta]$
    \item $a_{i \in 1..n}$ called \emph{the clause of lowered pivots}
  \end{subpart}
\end{frame}

\begin{frame}{Univalent clause}
  \begin{definition}[Valent literal]
  A literal $a$ is said to be valent w.r.t. a clause $\Delta$ iff $\bar{a}$
  does not occur in $\Delta$.
  \end{definition}

  \begin{definition}[Univalent clause]
  A clause $\Gamma$ is said to be univalent w.r.t. another clause $\Delta$ iff
  there is exactely one literal $a$ in $\Gamma$ which is valent w.r.t.
  $\Delta$.
  \end{definition}

  \addtocounter{beamerpauses}{1}
  \begin{subpart}{\only<+->{A univalent clause isn't sufficient for a node to be lowered}}
    \item<+-> $\Delta = \left\{ \bar{a} \right\}$ and $\eta$'s clause $= \left\{ a, b \right\}$
    \item<+-> $\eta$'s child with pivot $a$
    \item<+-> \alert{$\bar{a}$ propagated down the proof}
  \end{subpart}
\end{frame}

\begin{frame}{Active literals}
\begin{definition}[Active literal]
Let's consider a node $\eta$ with clause $\Gamma$. A literal $a$ from
$\Gamma$ is said to be an active literal of $\eta$ iff $a$ is the pivot of
one of $\eta$'s child.
\end{definition}

\begin{theorem}
If all the active literals of a node $\eta$ with clause $\Gamma$ univalent
w.r.t. the clause $\Delta$ of lowered literals either are the valent
literal $a$ or belong to $\Delta$, then $\eta$ can be lowered.
\end{theorem}
\end{frame}

\begin{frame}{Partial regularization}
\end{frame}

\begin{frame}{Algorithm}
  \SetKw{aElseIf}{else if}
  \SetKwFor{And}{and}{then}{endif}
  \begin{algorithm}[H]
    $\Delta \leftarrow \varnothing$ \;
    \For{every node $\eta$ in a top-down traversal}{
      Fix $\eta$ \;
      \uIf{every $\eta$'s active literal belongs to $\Delta$}{Delete $\eta$ \;}
    \aElseIf{$\eta$'s clause is univalent w.r.t. $\Delta$ with valent literal $a$}
    \And{$a$ is the only active literal not belonging to $\Delta$}{
        Lower $\eta$ \;
        $\Delta \leftarrow \Delta \cup \{ a \}$ \;
      }
     }
  \end{algorithm}
\end{frame}

\begin{frame}{Comparison with LU}
\centering
\only<+>{\include{LUniv-compress}}
\only<+>{\include{LUniv-axiom}}
\only<+>{\include{LUniv-time}}
\end{frame}

\appendix

\begin{frame}{Conclusion}
\renewcommand{\chartscale}{0.85}
\begin{columns}

  \column{0.45\textwidth}
  \centering
  \include{composition-chart}

  \column{0.55\textwidth}
  \centering
  \only<+>{\include{combination-chart}}
  \only<+>{\include{combluniv-chart}}
  
\end{columns}
\end{frame}

\begin{frame}{Références}

\begin{subpart}{Skeptik}
\item http://github.com/Paradoxika/Skeptik
\end{subpart}

\begin{subpart}{Bibliography}
\item Fontaine, P., Merz, S., Woltzenlogel Paleo, B.: Compression of
  propositional resolution proofs via partial regularization. In: CADE. Lecture
  Notes in Computer Science, vol. 6803, pp. 237--251. Springer (2011)
\end{subpart}

\end{frame}

\end{document}
